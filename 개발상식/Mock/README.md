# Mock

> Mock에 대해 큰 개념을 정리하고자 잘 정리된 블로그를 보고 한번 읽고 내용을 적어보았지만 설명과 내용에 대한 이해가 부족하다고 생각되어 추가적으로 내용을 보완한뒤 수정할 예정입니다.

## Mock이란?

실제 객체를 만들기엔 비용과 시간이 많이 들거나 의존성이 길게 걸쳐져 있어 제대로 구현하기 어려울 경우, 가짜 객체를 만들어 사용한다.

## Mock 객체는 언제 필요한가?

* 테스트 작성을 위한 환경 구축이 어려운 경우
  * 환경 구축을 위한 작업 시간이 많이 필요한 경우에 Mock 객체를 사용한다.
  * 특정 모듈을 갖고 있지 않아서 테스트 환경을 구축하지 못할 때 또는 타 부서와의 협의나 정책이 필요한 경우에 사용한다.
* 테스트가 특정 경우나 순간에 의존적인 경우
* 테스트 시간이 오래 걸리는 경우
* 개인 PC의 성능이나 서버의 성능 문제로 오래 걸릴 수 있는 경우 시간 단축을 위해 사용.



## Mock에 대한 기본적인 분류 개념

### 테스트 더블

* 테스트를 진행하기 어려운 경우 이를 대신해 테스트를 진행할 수 있도록 만들어주는 객체를 말한다.
* Mock 객체와 유사한 의미를 가지며 테스트 더블이 좀더 상위의 의미로 사용된다.

### 더미객체

* 단순히 인스턴스화 될 수 있는 수준으로만 객체를 구현한다.
* 인스턴스화된 객체가 필요할 뿐 객체의 기능까지는 필요하지 않은 경우에 사용한다.

### 테스트 스텁

* 더미 객체보다 좀더 구현된 객체로 더미 객체가 마치 실제로 동작하는 것처럼 보이게 만들어 놓은 객체이다.
* 객체의 특정 상태를 가정해서 만들어 특정 값을 리턴해 주거나 특정 메시지를 출력해 주는 작업을 한다.
* 특정 상태를 가정해서 하드코딩된 형태이기 때문에 로직에 따른 값의 변경은 테스트 할 수 없다.

### 페이크 객체

* 여러 상태를 대표할 수 있도록 구현된 객체로 실제 로직이 구현된 것 처럼 보이게 한다.
* 실제로 DB에 접속해서 비교할 때와 동일한 모양이 보이도록 객체 내부에 구현 할 수 있다.
  * 테스트케이스 작성을 위해서 다른 객체들과의 의존성을 제거하기 위해 사용한다.
  * 페이크 객체를 만들 때 복잡도로 인해서 노력이 많이 들어 갈 경우 적절한 수준에서 구현하거나, Mock 프레임 워크를 사용한다.
  * 페이크 객체를 생성하기 위한 노력이 많이 필요한 경우 실제 객체를 가져와 테스트 한다.

### 테스트 스파이

* 테스트에 사용되는 객체, 메소드의 사용 여부 및 정상 호출 여부를 기록하고 요청시 알려준다.
* 테스트 더블로 구현된 객체에 자기 자신이 호출 되었을 때 확인이 필요한 부분을 기록하도록 구현한다.
* 특정 테스트 메서드가 몇 번 호출되었는지 필요한 경우 전역 변수로 카운트를 설정하고 특정 테스트 메서드에 카운트를 올리는 부분을 추가한 후 이 카운트를 가져오는 메서드를 추가한다.
* 아주 특수한 경우를 제외하고는 잘 쓰이지 않으며 보통 Mock 프레임워크에서 기본적을 기능을 제공하므로 Mock을 사용한다.
* 특정 메소드가 호출 되었을때 또 다른 메서드가 시행되어야 한다와 같은 행위 기반 테스트가 필요한 경우 사용한다.

### Mock 객체(Mock Object)

* 행위를 검증하기 위해 사용되는 객체를 지칭하며 수동으로 만들 수도 있고 프레임워크를 통해 만들 수 있다.
* 행위 기반 테스트는 복잡도나 정확성등, 작성하기 어려운 부분이 많기 때문에 상태 기반 테스트가 가능하다면 만들지 않는다.
* Mock 객체는 테스트 더블 하위 객체로서의 좁은 의미와 테스트 더블을 포함한 넓은 의미 2가지로 사용된다.



## Mock 프레임워크

* 동적으로 mock 객체를 만들어주는 프레임워크
* Mock 객체를 명시적으로 생성하지 않아도 된다.
* 행위 기반 테스트도 가능하다.

### 대표적인 Mock 프레임워크

1. Easy Mock
2. jMock
3. Mockito



### Reference

* http://www.incodom.kr/Mock
